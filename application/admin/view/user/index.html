{extend name="layout/main" /}

{block name="header"}

{/block}

{block name="content"}
<style type="text/css">
    .link-th{
        color:blue;
    }
</style>
<script src="__PUBLIC__/admin/js/laydate/laydate.js"></script>
<section class="panel">
    <header class="panel-heading">
        <h4>会员列表</h4>
    </header>
    <div class="panel-body" style="padding-bottom: 50px">
        <form class="form-horizontal" action="{:url('admin/user/index')}">
            <div class="form-group">
                <div class="col-xs-1 no-pd-r">
                    <select name="type" id="type" class="form-control">
                        <option {if $Request.get.type == 'nick_name'} selected {/if} value="nick_name">用户名</option>
                        <option {if $Request.get.type == 'mobile'} selected {/if} value="mobile">手机号</option>
                    </select>
                </div>
                <div class="col-xs-3 no-pd-l">
                    <input type="text" id="keyword" value="{$Request.get.keyword}" name="keyword" class="form-control" placeholder="请输入关键词搜索">
                </div>
                <div class="col-xs-2 no-pd-2">
                    <input type="text" value="{$Request.get.startTime}" name="startTime" id="startTime" class="form-control" placeholder="请输入开始时间">
                </div>
                <div class="col-xs-2 no-pd-2">
                    <input type="text" value="{$Request.get.endTime}" name="endTime" id="endTime" class="form-control" placeholder="请输入结束时间">
                </div>
                <button type="submit" class="btn btn-color">搜索</button>
                <!--<button type="button" class="btn btn-success" id="export">导出</button>-->
                <a type="button" href="{:url('admin/user/create')}" class="btn btn-info">添加会员</a>
            </div>
        </form>
        <table class="table table-bordered table-striped no-margin">
            <thead>
            <tr>
                <th class="text-center">会员ID</th>
                <th class="text-center">会员账号</th>
                <th class="text-center">昵称</th>
                <th class="text-center">上级信息</th>
                <th class="text-center">注册信息</th>
                <th class="text-center">等级</th>
                <th class="text-center">状态</th>
                <th class="text-center">佣金账户</th>
                <th class="text-center">保证金账户</th>
                <th class="text-center">代理账户</th>
                <th class="text-center">直推人数</th>
                <th class="text-center">操作</th>
            </tr>
            </thead>
            <tbody>
            {if !empty($list)}
                {foreach $list as $entity}
                <tr>
                    <td style="vertical-align: middle" class="text-center">
                        {$entity->id}<br>
                    </td>
                    <td style="vertical-align: middle" class="text-center">
                        {$entity->nick_name}
                    </td>
                    <td style="vertical-align: middle" class="text-center">
                        手机号：{$entity->mobile}<br>
                        邀请码：{$entity->invite_code}
                    </td>
                    <td style="vertical-align: middle" class="text-center">
                        {if $entity->getParentInfo()}
                            ID：{$entity->getParentInfo()->id} <br>
                        手机号：{$entity->getParentInfo()->mobile}
                        {else /}
                            无
                        {/if}
                    </td>

                    <td style="vertical-align: middle" class="text-center">
                        时间：{$entity->register_time}<br>
                        ip：{$entity->register_ip}
                    </td>
                    <td style="vertical-align: middle" class="text-center">
                        {$entity->getLevel( $entity->level )}
                    </td>
                    <td style="vertical-align: middle" class="text-center">
                        {if $entity->status == -1}
                        <a class="btn btn-xs btn-danger">禁用</a>
                         <span>禁用时间：{$entity->getForbiddenTime()}</span>
                        {else /}
                        <a class="btn btn-xs btn-success">正常</a>
                        {/if}
                    </td>
                    <td class="text-center">
                        {$entity->number}
                    </td>
                    <td class="text-center">
                        {$entity->bond}
                    </td>
                    <td class="text-center">
                        {$entity->agent}
                    </td>
                    <td class="text-center">
                        {$entity->next_count}
                    </td>
                    <td style="vertical-align: middle" class="text-center">
                        <a href="{:url('user/editUser',['id'=>$entity->id])}" class="btn btn-xs btn-info">修改</a>
                        <a href="{:url('user/recharge',['id'=>$entity->id])}" class="btn btn-xs btn-primary">充值</a>
                            {if $entity->status == -1}
                                <a data-url="{:url('user/activation',['id'=>$entity->id])}" onclick="main.ajaxDelete(this)" data-msg="确定要激活此会员吗？" class="btn btn-xs btn-success">激活</a>
                            {else /}
                                <a data-url="{:url('user/freeze',['id'=>$entity->id])}" onclick="main.ajaxDelete(this)" data-msg="确定要冻结此会员吗？" class="btn btn-xs btn-warning">冻结</a>
                            {/if}

                        <a data-url="{:url('user/delete',['id'=>$entity->id])}" onclick="main.ajaxDelete(this)" data-msg="确定要删除此会员吗？" class="btn btn-xs btn-danger">删除</a>
                    </td>
                </tr>
                {/foreach}
            {else /}
            <tr class="text-center">
                <td colspan="9">暂无数据</td>
            </tr>
            {/if}
            </tbody>
        </table>
        <div class="page">
            {:htmlspecialchars_decode($list->render())}
        </div>
    </div>
</section>
<script>
    laydate.render({
        elem: '#startTime',
        type: 'datetime'
    });
    laydate.render({
        elem: '#endTime',
        type: 'datetime'
    });
</script>
{/block}
{block name="footer"}



{/block}
