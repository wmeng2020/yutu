{extend name="layout/main" /}

{block name="header"}

{/block}
{block name="left"}{/block}

{block name="content"}
<div class="row">
    <div class="col-lg-12 col-sm-6" style="padding-right: 0">
        <section class="panel">
            <header class="panel-heading">
                <h4>新增会员趋势图</h4>
            </header>
            <div class="panel-body">
                <div id="magic" style="width: 100%;height: 200px">

                </div>
            </div>
        </section>
    </div>
</div>
<div class="row">
    <div class="col-lg-3 col-md-3" style="padding-left: 0">
        <section class="panel ">
            <header class="panel-heading">
                <h4>会员数量</h4>
            </header>
            <div class="panel-body">
                <h3>{$user['total']}人</h3>
            </div>
        </section>
    </div>
    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>今日会员注册数量</h4>
            </header>
            <div class="panel-body">
                <h3>{$user['today']}人</h3>
            </div>
        </section>
    </div>
    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>昨日会员注册数量</h4>
            </header>
            <div class="panel-body">
                <h3>{$user['yesterday']}人</h3>
            </div>
        </section>
    </div>

    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>充值统计</h4>
            </header>
            <div class="panel-body">
                <h3>￥{$money['recharge']}</h3>
            </div>
        </section>
    </div>
    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>提现统计</h4>
            </header>
            <div class="panel-body">
                <h3>￥{$money['withdrawal']}</h3>
            </div>
        </section>
    </div>
    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>今日充值金额<span style="color: red"></span></span></h4>
            </header>
            <div class="panel-body">
                <h3>￥{$money['today_recharge']}</h3>
            </div>
        </section>
    </div>
    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>今日提现金额</h4>
            </header>
            <div class="panel-body">
                <h3>￥{$money['today_withdrawal']}</h3>
            </div>
        </section>
    </div>
    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>昨日提现金额</h4>
            </header>
            <div class="panel-body">
                <h3>￥{$money['yesterday_withdrawal']}</h3>
            </div>
        </section>
    </div>
    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>今日报名人数</h4>
            </header>
            <div class="panel-body">
                <h3>{$participate_game_num}人</h3>
            </div>
        </section>
    </div>
    <div class="col-lg-3 col-md-3">
        <section class="panel">
            <header class="panel-heading">
                <h4>今日奖金发放</h4>
            </header>
            <div class="panel-body">
                <h3>￥{$total_bonus}</h3>
            </div>
        </section>
    </div>

    <div>
        <audio src="__PUBLIC__/admin/ding.mp3" id="audio"></audio>
    </div>


</div>
<p id="level" data="{$level}"></p>
{/block}
{block name="footer"}
<script src="/admin/js/echarts.min.js"></script>

<script>
    var magicChart = echarts.init(document.getElementById('magic'));
    var magic = {
        title: {
            text: '新增会员趋势图',
            x: 'center'
        },
        tooltip: {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient: 'vertical',
            left: 'left',
            data: ['运行中', '已过期']
        },
        series: [
            {
                type: 'pie',
                radius: '55%',
                center: ['50%', '60%'],
                data: [
                    {value: "{$magic['running'] ? $magic['running'] : 0}", name: '运行中'},
                    {value: "{$magic['stop'] ? $magic['stop'] : 0}", name: '已过期'}
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };
    magicChart.setOption(magic);
</script>
<script>
    $(function () {
        var timer = null,isSuccess = true,audio = $('#audio');
        /*定时器*/
        var startTimer = function (num = 1) {
            clearInterval(timer);
            timer = setInterval(function () {
                if(isSuccess){
                    // console.log(12);
                    document.getElementById('audio').play();
                    audio[0].play();
                    sendAjax();
                }
            },num * 1000)
        };

        // var sendAjax = function(){
        //     isSuccess = false;
        //     $.ajax({
        //         url : "{:url('admin/index/remind')}",
        //         methods : 'post',
        //         data :{},
        //         success : function (res) {
        //             console.log(res);
        //             isSuccess = true;
        //             if(res.code == 0){
        //                 audio[0].play();
        //             };
        //         },
        //         error : function (err) {
        //             isSuccess = true;
        //         }
        //     })
        //
        // };
        // startTimer(3);
    });







    var orderChart = echarts.init(document.getElementById('magic'));
    orders = {
        color: ['#3398DB'],
        tooltip : {
            trigger: 'axis',
            axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
            }
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis : [
            {
                type : 'category',
                data : ['昨天','今天','明天'],
                axisTick: {
                    alignWithLabel: true
                }
            }
        ],
        yAxis : [
            {
                type : 'value'
            }
        ],
        series : [
            {
                name:'增长量',
                type:'bar',
                barWidth: '60%',
                data:[{$user['yesterday']},{$user['today']},0]
            }
        ]
    };
    orderChart.setOption(orders);
</script>
{/block}
